
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#security" class="toc-h1 toc-link" data-title="Security">Security</a>
          </li>
          <li>
            <a href="#access-token" class="toc-h1 toc-link" data-title="Access Token">Access Token</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#the-access-token-object" class="toc-h2 toc-link" data-title="The Access Token Object">The Access Token Object</a>
                  </li>
                  <li>
                    <a href="#post-create-access-token" class="toc-h2 toc-link" data-title="[POST] Create Access Token">[POST] Create Access Token</a>
                  </li>
                  <li>
                    <a href="#post-refresh-access-token" class="toc-h2 toc-link" data-title="[POST] Refresh Access Token">[POST] Refresh Access Token</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#enabled-perk-redemption" class="toc-h1 toc-link" data-title="Enabled Perk Redemption">Enabled Perk Redemption</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#the-enabled-perk-redemption-object" class="toc-h2 toc-link" data-title="The Enabled Perk Redemption Object">The Enabled Perk Redemption Object</a>
                  </li>
                  <li>
                    <a href="#get-list-enabled-perk-redemptions" class="toc-h2 toc-link" data-title="[GET] List Enabled Perk Redemptions">[GET] List Enabled Perk Redemptions</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the Portify Client API. This is a private API reserved only for use by Portify&#39;s client organisations.</p>

<p>To be able to use this API, you must have been given the following variables, unique to your organisation:</p>

<p>APP_ID (unique identifier for your app)</p>

<p>SECRET (unique password for your app, used when creating a new access_token)</p>

<p>ENV_URL (url where the Portify Client API is hosted)</p>
<h1 id='authentication'>Authentication</h1>
<p>As a client organisation that has requested access to this API, you will have received an APP_ID and SECRET.</p>

<p>1) Use these credentials on the access_tokens#create endpoint to create an access token. Store this token as it is used to authenticate future requests. It is recommended to store the corresponding refresh token as well.</p>

<p>2) Your access token will expire 24 hours after creation. When the token expires, use the access_token#update endpoint to revive the same access token for another 24 hours.</p>

<p>You can create a new access token instead, though this is not advised. Creating a new access token will invalidate any other active access tokens belonging to your application.</p>
<h1 id='security'>Security</h1>
<p>In addition to the aforementioned SECRET tokens and access token authentication, the Portify Client API will reject any requests from IP addresses that you have not whitelisted. Please contact the Portify development team to manage your whitelisted IPs.</p>

<p>This feature can be disabled on request for the staging environment.</p>
<h1 id='access-token'>Access Token</h1><h2 id='the-access-token-object'>The Access Token Object</h2>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>The access token</td>
</tr>
<tr>
<td>expires_at</td>
<td>The datetime at which the access token will expire if not refreshed</td>
</tr>
<tr>
<td>refresh_token</td>
<td>The token that can be used to revive the access token for another 24 hours</td>
</tr>
<tr>
<td>refreshed_at</td>
<td>The datetime at which the access token was last refreshed</td>
</tr>
</tbody></table>
<h2 id='post-create-access-token'>[POST] Create Access Token</h2><pre class="highlight shell tab-shell"><code>curl <span class="s2">"ENV_URL/clients/access_tokens"</span>
  -X POST
  -H <span class="s2">"Authorization"</span>: <span class="s2">"Token token=SECRET"</span>
  -H <span class="s2">"Accept"</span>: <span class="s2">"application/json"</span>
  -H <span class="s2">"Content-Type"</span>: <span class="s2">"application/json"</span>
  -d <span class="s1">'{
    "app_id": APP_ID
  }'</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"W801u8F66xSb_qNRJLXwxczorZVhUku3MM5vSP95arY"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-17T15:35:30.182Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"qaKgQejogCPUyNfs8WNF5qEx"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"refreshed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns an access token valid for up to 24 hours, before it needs to be refreshed.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SECRET</td>
<td>Your application&#39;s secret token [required]</td>
</tr>
<tr>
<td>app_id</td>
<td>You application&#39;s app id [required]</td>
</tr>
</tbody></table>
<h2 id='post-refresh-access-token'>[POST] Refresh Access Token</h2><pre class="highlight shell tab-shell"><code>curl <span class="s2">"ENV_URL/clients/access_tokens/refresh"</span>
  -X POST
  -H <span class="s2">"Accept"</span>: <span class="s2">"application/json"</span>
  -H <span class="s2">"Content-Type"</span>: <span class="s2">"application/json"</span>
  -d <span class="s1">'{
    "app_id": APP_ID,
    "access_token": ACCESS_TOKEN,
    "refresh_token": REFRESH_TOKEN
  }'</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"W801u8F66xSb_qNRJLXwxczorZVhUku3MM5vSP95arY"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-17T16:08:35.519Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FXbXovzza53FyiJMnEyEobDd"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"refreshed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-16T16:08:35.519Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns your access token with an updated expires_at timestamp and regenerated refresh_token.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>app_id</td>
<td>Your application&#39;s app id [required]</td>
</tr>
<tr>
<td>access_token</td>
<td>The access token you wish to refresh [required]</td>
</tr>
<tr>
<td>refresh_token</td>
<td>The correct corresponding refresh token for the access token [required]</td>
</tr>
</tbody></table>
<h1 id='enabled-perk-redemption'>Enabled Perk Redemption</h1><h2 id='the-enabled-perk-redemption-object'>The Enabled Perk Redemption Object</h2>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>The unique identifier for this perk redemption</td>
</tr>
<tr>
<td>enrolment_id</td>
<td>The ID of the enrolled user</td>
</tr>
<tr>
<td>brand</td>
<td>The brand of perk that was redeemed</td>
</tr>
<tr>
<td>value</td>
<td>The value of the item purchased by the user (subunits)</td>
</tr>
<tr>
<td>discount</td>
<td>A URL to your application&#39;s logo (visible on authorization page)</td>
</tr>
<tr>
<td>money_saved</td>
<td>The amount of money the user saved by using this perk (subunits)</td>
</tr>
<tr>
<td>created_at</td>
<td>The datetime at which the perk was redeemed</td>
</tr>
</tbody></table>
<h2 id='get-list-enabled-perk-redemptions'>[GET] List Enabled Perk Redemptions</h2><pre class="highlight shell tab-shell"><code>curl <span class="s2">"ENV_URL/clients/enabled_perk_redemptions?app_id=APP_ID&amp;created_since=2018-11-15%2016:10:24.487877"</span>
  -X GET
  -H <span class="s2">"Accept"</span>: <span class="s2">"application/json"</span>
  -H <span class="s2">"Content-Type"</span>: <span class="s2">"application/json"</span>
  -H <span class="s2">"Authorization"</span>: <span class="s2">"Token token=ACCESS_TOKEN"</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"enabled_perk_redemptions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9ffb5c2c-5e65-4a03-bfaa-d06426222b2a"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"enrolment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be8172a5-a51b-462d-816b-1ebc63ca0b95"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Amazon"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">5.0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"money_saved"</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="p">,</span><span class="w">
      </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-15T16:10:24.499Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ff7df128-74f9-4a5b-a154-e574f823f705"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"enrolment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be8172a5-a51b-462d-816b-1ebc63ca0b95"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tesco"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">5.0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"money_saved"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
      </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-15T16:10:24.506Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e6b76648-fef8-4df8-9093-47633f5cd67d"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"enrolment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"be8172a5-a51b-462d-816b-1ebc63ca0b95"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Spotify"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"money_saved"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-11-15T16:10:24.513Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns up to 50 perk redemptions created since the specified time.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ACCESS_TOKEN</td>
<td>Your application&#39;s active access token [required]</td>
</tr>
<tr>
<td>app_id</td>
<td>Your application&#39;s app id [required]</td>
</tr>
<tr>
<td>created_since</td>
<td>Datetime from which you&#39;d like to receive the next page of perk redemptions [required]</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
